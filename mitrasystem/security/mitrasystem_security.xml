<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Security Groups -->
        <record id="group_mitrasystem_user" model="res.groups">
            <field name="name">MitraSystem / User</field>
            <field name="category_id" ref="base.module_category_hidden"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        <record id="group_mitrasystem_manager" model="res.groups">
            <field name="name">MitraSystem / Manager</field>
            <field name="category_id" ref="base.module_category_hidden"/>
            <field name="implied_ids" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="users" eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"/>
        </record>

        <record id="group_mitrasystem_admin" model="res.groups">
            <field name="name">MitraSystem / Administrator</field>
            <field name="category_id" ref="base.module_category_hidden"/>
            <field name="implied_ids" eval="[(4, ref('group_mitrasystem_manager'))]"/>
            <field name="users" eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"/>
        </record>

        <!-- Record Rules -->
        <!-- Project Rules -->
        <record id="rule_mitra_project_user" model="ir.rule">
            <field name="name">MitraSystem Project: User sees only assigned projects</field>
            <field name="model_id" ref="model_mitra_project"/>
            <field name="domain_force">['|', ('pic_id.user_id', '=', user.id), ('team_member_ids.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_project_manager" model="ir.rule">
            <field name="name">MitraSystem Project: Manager sees all projects</field>
            <field name="model_id" ref="model_mitra_project"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Task Rules -->
        <record id="rule_mitra_project_task_user" model="ir.rule">
            <field name="name">MitraSystem Task: User sees only assigned tasks</field>
            <field name="model_id" ref="model_mitra_project_task"/>
            <field name="domain_force">['|', ('assignee_id.user_id', '=', user.id), ('project_id.pic_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_project_task_manager" model="ir.rule">
            <field name="name">MitraSystem Task: Manager sees all tasks</field>
            <field name="model_id" ref="model_mitra_project_task"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Staff Rules -->
        <record id="rule_mitra_staff_user" model="ir.rule">
            <field name="name">MitraSystem Staff: User sees only own record</field>
            <field name="model_id" ref="model_mitra_staff"/>
            <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_staff_manager" model="ir.rule">
            <field name="name">MitraSystem Staff: Manager sees all staff</field>
            <field name="model_id" ref="model_mitra_staff"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Handover Rules -->
        <record id="rule_mitra_handover_user" model="ir.rule">
            <field name="name">MitraSystem Handover: User sees only related handovers</field>
            <field name="model_id" ref="model_mitra_handover"/>
            <field name="domain_force">['|', '|', ('from_employee_id.user_id', '=', user.id), ('to_employee_id.user_id', '=', user.id), ('project_id.pic_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_handover_manager" model="ir.rule">
            <field name="name">MitraSystem Handover: Manager sees all handovers</field>
            <field name="model_id" ref="model_mitra_handover"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Evaluation Rules -->
        <record id="rule_mitra_evaluation_user" model="ir.rule">
            <field name="name">MitraSystem Evaluation: User sees only related evaluations</field>
            <field name="model_id" ref="model_mitra_evaluation"/>
            <field name="domain_force">['|', ('evaluator_id.user_id', '=', user.id), ('project_id.pic_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_evaluation_manager" model="ir.rule">
            <field name="name">MitraSystem Evaluation: Manager sees all evaluations</field>
            <field name="model_id" ref="model_mitra_evaluation"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Complaint Rules -->
        <record id="rule_mitra_complaint_user" model="ir.rule">
            <field name="name">MitraSystem Complaint: User sees only assigned complaints</field>
            <field name="model_id" ref="model_mitra_complaint"/>
            <field name="domain_force">['|', ('pic_id.user_id', '=', user.id), ('project_id.pic_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_complaint_manager" model="ir.rule">
            <field name="name">MitraSystem Complaint: Manager sees all complaints</field>
            <field name="model_id" ref="model_mitra_complaint"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>

        <!-- Report Rules -->
        <record id="rule_mitra_report_user" model="ir.rule">
            <field name="name">MitraSystem Report: User sees only own reports</field>
            <field name="model_id" ref="model_mitra_report"/>
            <field name="domain_force">[('creator_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_mitra_report_manager" model="ir.rule">
            <field name="name">MitraSystem Report: Manager sees all reports</field>
            <field name="model_id" ref="model_mitra_report"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_mitrasystem_manager'))]"/>
        </record>
    </data>
</odoo>